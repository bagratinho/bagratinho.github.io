<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/main.css">
  <title>y-Hat</title>
</head>
<body>
  <header class="main">
    <h1 class="logo"><a href="">PRISMATIK</a></h1>
    <nav class="main-nav">
      <ul>
        <li><a href="">NAVIGATION</a></li>
        <li><a href="">NAVIGATION</a></li>
        <li><a href="">NAVIGATION</a></li>
        <li><a href="">NAVIGATION</a></li>
        <li><a href="">NAVIGATION</a></li>
      </ul>
    </nav>
  </header>
  <section class="main-dashboard">
    <div class="primary-list">
      <header class="primary space-between-align ">
        <h3>SELECT MAIN PRODUCT</h3>
        <div class="search-bar">
          <input type="text" placeholder="SEARCH PRODUCT">
        </div>
      </header>
      <header class="secondary center-align">
        "LONG SLEEVE" SEARCH RESULTS
      </header>
      <header class="product-table-header">
        <div class="col">
          PHOTO
        </div>
        <div class="col">
          DESCRIPTION
        </div>
      </header>
      <section class="product-list">
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
        <div class="product-item">
          <div class="col">
            <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
          </div>
          <div class="col">
            Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
          </div>
        </div>
      </section>
    </div>
    <div class="rest">
      <div class="modal-preview">
        <header class="primary center-align">
          <h3>PRISM VIEW</h3>
        </header>
        <div class="prsmtk-modal-inner-right" style="padding: 80px;">
          <div style="width: 320px; height: 320px;">
            <div class="prsmtk-item" style="left: 80px; top: 80px;">
            <div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: 80px; top: -80px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: 218.564px; top: 0px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: 218.564px; top: 160px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: 80px; top: 240px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: -58.5641px; top: 160px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>

            <div class="prsmtk-item" style="left: -58.5641px; top: 0px;">
            <div>
              <div class="label">
                DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
              </div>
            </div>
            </div>
          </div>
        </div>
        <div class="action-bar">
          <button id="hex-save-button" >SAVE</button>
          <button id="hex-delete-button" class="alert">DELETE</button>
          <button id="hex-cancel-button" class="enabled">CANCEL</button>
        </div>
        <div class="reserve">
          <header class="primary center-align">
            <h3>RESERVE PRODUCTS</h3>
          </header>
          <div class="reserve-items">
            <div class="prsmtk-item">
              <div>
                <div class="label">
                  DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
                </div>
              </div>
            </div>
            <div class="prsmtk-item">
              <div>
                <div class="label">
                  DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
                </div>
              </div>
            </div>
            <div class="prsmtk-item">
              <div>
                <div class="label">
                  DRAG AND DROP THE PHOTO OF THE DESIRED PRODUCTS FROM THE LIST ON THE RIGHT
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="secondary-list">
        <header class="primary space-between-align ">
          <h3>SELECT SUPPORTING PRODUCTS</h3>
          <div class="search-bar">
            <input type="text" placeholder="SEARCH PRODUCT">
          </div>
        </header>
        <header class="secondary center-align">
          "LONG SLEEVE" SEARCH RESULTS
        </header>
        <header class="product-table-header">
          <div class="col">
            PHOTO
          </div>
          <div class="col">
            DESCRIPTION
          </div>
          <div class="col">
            STATUS
          </div>
          <div class="col">
            INVENTORY
          </div>
          <div class="col">
            INSIGHTS
          </div>
        </header>
        <section class="product-list">
          <div class="product-item">
            <div class="col">
              <img data-pid="qaq" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img data-pid="cer" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img data-pid="gorex" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img data-pid="kldir" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img data-pid="zhazhq" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img data-pid="puc" src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
          <div class="product-item">
            <div class="col">
              <img src="https://cdn.shopify.com/s/files/1/2599/5098/products/blackdriver2.jpg?v=1591747755" alt="">
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              <div class="status active">ACTIVE</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          </div>
        </section>
      </div>
    </div>
  </section>

  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
    $(function() {
      var originalProductList = [];
      var primaryProductList = [];
      var secondaryProductList = [];
      var secondaryProductListKeyword = "";
      var primaryProductListKeyword = "";
      var selectedPid;
      var currentSavedMerchList = [];
      var currentMerchList = [];
      var originalProductList = [];
      var isSaveButtonEnabled = false;
      var isDeleteButtonEnabled = false;
      $(".action-bar").on("click", "#hex-delete-button", function () {
        deleteMerchList(selectedPid);
        clearHex();
      });
      $(".action-bar").on("click", "#hex-save-button", function () {
        saveMerchList(selectedPid, currentMerchList);
        clearHex();
      });
      $(".action-bar").on("click", "#hex-cancel-button", function () {
        clearHex();
      });
      $(".prsmtk-item").on("click", ".product-remove-trigger", function () {
        var pid = $(this).attr("data-pid");
        currentMerchList = currentMerchList.filter(i => i !== pid);
        console.log(currentMerchList);
        $(this).parent().find("img").remove();
        $(this).remove();
        updateButtonsState();
      });
      $(".secondary-list .product-list .product-item img").draggable({ opacity: 1, helper: "clone" });
      $(".modal-preview .prsmtk-item > div").droppable({
        accept: ".product-list .product-item img",
        drop: function( event, ui ) {
          var src = ui.draggable.attr("src");
          var pid = ui.draggable.attr("data-pid");
          if (currentMerchList.indexOf(pid) === -1) {
            currentMerchList.push(pid);
            $(this).append(`<img src="${ui.draggable.attr("src")}"" />`);
            $(this).parent().append(`<i class="product-remove-trigger" data-pid="${pid}"/>`);
            updateButtonsState();
          } else {
            dispatchStatusMessage("warning", "The list already contains this product");
          }
        }
      });
      var updateSecondaryList = function() {
        secondaryProductList = originalProductList.filter(i => i.name.indexOf(secondaryProductListKeyWord) !== -1);
        redrawSecondaryList();
      }
      var updatePrimaryList = function() {
        primaryProductList = originalProductList.filter(i => i.name.indexOf(primaryProductListKeyWord) !== -1);
        redrawPrimaryList();
      }
      var redrawPrimaryList = function() {
        $(".primary-list .product-list").empty();
        var html = primaryProductList.reduce((acc, item) => {
          return item.active ? `
            ${acc}
            <div class="product-item" data-pid="${item.product_id}">
              <div class="col">
                <img src="${item.image_url}"/>
              </div>
              <div class="col">
                ${item.name}
              </div>
            </div>
          ` : acc;
        }, "")
        $(".primary-list .product-list").append(html);
      }
      var redrawSecondaryList = function() {
        $(".secondary-list .product-list").empty();
        var html = secondaryProductList.reduce((acc, item) => {
          return `
            ${acc}
            <div class="product-item" >
              <div class="col">
                <img data-pid="${item.product_id}" src="${item.image_url}"/>
              </div>
              <div class="col">
                ${item.name}
              </div>
            </div>
            <div class="col">
              <div class="status active">${item.active}</div>
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
            <div class="col">
              Lorem ipsum dolor sit amet consectetur, adipisicing elit. Ratione debitis vero ab totam officiis repellat.
            </div>
          `;
        }, "")
        $(".primary-list .product-list").append(html);
      }
      var onSecondarySearchChange = function(e) {
        secondaryProductListKeyWord = e.target.value;
        updateSecondaryList();
      }
      var onPrimarySearchChange = function(e) {
        primaryProductListKeyWord = e.target.value;
        updatePrimaryList();
      }
      var dispatchStatusMessage = function(type, message) {

      }
      var clearHex = function() {
        selectedPid = undefined;
        currentMerchList = [];
        currentSavedMerchList = [];
        isSaveButtonEnabled = false;
        isDeleteButtonEnabled = false;
        primaryProductList = originalProductList;
        secondaryProductList = originalProductList;
        secondaryProductListKeyword = "";
        updateButtonsState();
        updateSecondaryList();
        $(".modal-preview .prsmtk-item img").remove();
        $(".modal-preview .prsmtk-item img").remove();
        $(".main-dashboard .rest").addClass("disabled");
      }
      var redrawButtons = function() {
        if (isDeleteButtonEnabled) {
          $("#hex-delete-button").addClass("enabled");
        } else {
          $("#hex-delete-button").removeClass("enabled");
        }
        if (isSaveButtonEnabled) {
          $("#hex-save-button").addClass("enabled");
        } else {
          $("#hex-save-button").removeClass("enabled");
        }
      }
      var isMerchListModified = function() {
        if (currentSavedMerchList.length !== 6) {
          return true;
        } else {
          return currentMerchList.reduce((acc, item) => `${acc}${item}`, "") !==
            currentSavedMerchList.reduce((acc, item) => `${acc}${item}`, "");
        }
      }
      var updateButtonsState = function() {
        isSaveButtonEnabled = currentMerchList.length === 6 && isMerchListModified();
        isDeleteButtonEnabled = currentSavedMerchList.length === 6;
        redrawButtons();
      }
    });
  </script>
</body>
</html>